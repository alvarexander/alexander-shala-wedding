<div class="rsvp">
    <mat-card appearance="outlined" class="rsvp__card animate__animated animate__zoomIn">
        <mat-card-header class="d-flex align-items-center">
            <mat-card-title>RSVP To Our Special Day</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            @if (loading()) {
                <div class="rsvp__loading">Loading details…</div>
            } @else {
                <div class="rsvp__error">{{ error() }}</div>
            }

            @if (!loading() && !error() && info()) {
                <p>
                    @if ((info()?.guest_names?.length || 0) > 0) {
                        <b>{{ (info()?.guest_names || []).join(', ') }}</b>
                    }
                    <br />
                    <br />
                    Shala and I are so excited to celebrate our special day with you! We would be honored to have you
                    here to share our love and celebrate our special day together.
                    <br />
                    <br />

                    Our wedding will take place on Saturday, September 26th, 2025 at 5:00 PM EST at:
                    <br />
                    <br />
                    <i>
                        Chapel & Cellar <br />
                        216 W. Lyman Avenue <br />
                        Winter Park, FL 32789
                    </i>
                    <br />
                    <br />

                    Your presence means the world to us, and we can’t wait to share this joyful occasion together. To help
                    us make sure we plan and prepare accordingly, please check off all the names of the guests that are planning
                    to come. Don't worry if something changes later, you can always update your RSVP right here! We look
                    forward to celebrating with you!
                    <br />
                    <br />
                    <b>
                        Kindly note that due to venue limitations and budgeting, we are only able to accommodate the
                        guests listed on the invitation. We truly appreciate your understanding and can’t wait to
                        celebrate with each of you!
                    </b>
                </p>
                <div class="rsvp__details">
                    @if ((info()?.guest_names?.length || 0) > 1) {
                        <div class="rsvp__detail">
                            <span>Select Which Guest(s) Plan To Attend</span>
                            <span class="value value--checkboxes">
                                @for (name of info()?.guest_names; track name) {
                                    <mat-checkbox
                                        color="primary"
                                        class="rsvp__guest-checkbox"
                                        [checked]="isSelected(name)"
                                        (change)="toggleGuest(name, $event.checked)"
                                        >{{ name }}</mat-checkbox
                                    >
                                }
                            </span>
                        </div>
                    }
                    <div class="rsvp__detail">
                        <span>Invited Guest(s)</span>
                        <span class="value">{{ (info()?.guest_names || []).join(', ') || '—' }}</span>
                    </div>
                    <div class="rsvp__detail">
                        <span>Party Size</span>
                        <span class="value">{{ info()?.party_size ?? '—' }}</span>
                    </div>
                    <div class="rsvp__detail">
                        <span>Current Status</span>
                        <span class="value status status--{{ info()?.rsvp_response }}">{{
                            info()?.rsvp_response || 'pending' | uppercase
                        }}</span>
                    </div>
                </div>

                <div class="rsvp__actions">
                    <button
                        mat-flat-button
                        color="primary"
                        class="yes"
                        [disabled]="submitting() === 'yes'"
                        (click)="rsvp('yes')"
                    >
                        Set Your RSVP Response
                    </button>
                </div>
                @if (submitMessage()) {
                    <div class="rsvp__message">{{ submitMessage() }}</div>
                }
            }
        </mat-card-content>
    </mat-card>
</div>
